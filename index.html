<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>French Flashcard Game v1.2.3</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
<style>
body { font-family: 'Montserrat', sans-serif; background: linear-gradient(135deg, #f8f9fa, #e9ecef); display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; min-height: 100vh; position: relative; }
h1 { margin-bottom: 20px; color: #333; }
.card { background: white; padding: 25px; border-radius: 14px; box-shadow: 0 6px 16px rgba(0,0,0,0.1); text-align: center; max-width: 500px; width: 100%; height: 300px; margin-bottom: 20px; opacity: 1; transition: opacity 0.4s ease, transform 0.4s ease; display: flex; flex-direction: column; justify-content: center; position: relative; }
button { margin: 8px; padding: 12px 24px; border: none; border-radius: 8px; background: #0077cc; color: white; cursor: pointer; font-size: 16px; font-family: 'Montserrat', sans-serif; transition: background 0.3s, transform 0.2s; }
button:hover { background: #005fa3; transform: scale(1.05); }
#display-word { font-size: 38px; font-weight: 700; margin-bottom: 20px; transition: opacity 0.3s ease; }
.version { position: fixed; bottom: 10px; right: 15px; font-size: 14px; color: #666; }
#score-card { text-align: center; }
#score-card button { margin-top: 10px; }
.submenu { display: flex; flex-direction: column; }
input { font-size: 20px; text-align:center; border-radius:8px; border:2px solid #ccc; transition: background 0.3s, border-color 0.3s; padding:8px; margin-bottom: 15px; }
input.correct { background:#e6ffe6; border-color:#2ecc71; }
input.incorrect { background:#ffe5e5; border-color:#e74c3c; }
.fade-out { opacity:0; transform: scale(0.95);}
.hint { font-size: 14px; color: #666; margin-top: 10px; margin-bottom: 15px; }
</style>
</head>
<body>

<h1>French Flashcard Game</h1>

<!-- Main Menu -->
<div class="card" id="menu">
  <p>Select practice mode:</p>
  <button onclick="showSubMenu('fr-en')">French → English</button>
  <button onclick="showSubMenu('en-fr')">English → French</button>
  <button onclick="showSubMenu('mixed')">Mixed Practice</button>
</div>

<!-- Sub Menu -->
<div class="card submenu" id="submenu" style="display:none;">
  <p>Select category:</p>
  <button onclick="startGame(currentMode, 'subjects')">Subjects</button>
  <button onclick="startGame(currentMode, 'infinitives')">Infinitives</button>
  <button onclick="goBackToMain()">Back</button>
</div>

<!-- Game Card -->
<div class="card" id="game" style="display:none;">
  <div id="display-word"></div>
  <input type="text" id="answer" placeholder="Type your answer">
  <div class="hint">Hold Right Shift to peek translation</div>
  <button onclick="finishGame()">Finish</button>
</div>

<!-- Score -->
<div class="card" id="score-card" style="display:none;">
  <h2>Score</h2>
  <div id="score"></div>
  <button onclick="goBackToMain()">Back to Menu</button>
  <button onclick="resetAndPlayAgain()">Play Again</button>
</div>

<div class="version">1.2.3</div>

<!-- JS -->
<script src="data.js"></script> <!-- Word lists -->
<script>
// State
let currentMode="", currentCategory="", currentCard=null, askInFrench=true;
let score=0, answered=0;
let remainingCards=[];

// Menus
function showSubMenu(mode){
  currentMode=mode;
  document.getElementById("menu").classList.add("fade-out");
  setTimeout(()=>{
    document.getElementById("menu").style.display="none";
    document.getElementById("submenu").style.display="block";
    document.getElementById("menu").classList.remove("fade-out");
  },300);
}
function goBackToMain(){
  document.getElementById("submenu").style.display="none";
  document.getElementById("score-card").style.display="none";
  document.getElementById("menu").style.display="block";
}
function startGame(mode,category){
  currentMode=mode;
  currentCategory=category;
  score=0;
  answered=0; // ✅ reset
  remainingCards = [...(category==='infinitives'?infinitives:subjects)];
  document.getElementById("submenu").classList.add("fade-out");
  setTimeout(()=>{
    document.getElementById("submenu").style.display="none";
    document.getElementById("game").style.display="block";
    document.getElementById("submenu").classList.remove("fade-out");
    nextWord();
  },300);
}

// Next Word
function nextWord(){
  if(remainingCards.length===0){ finishGame(); return; }
  const answerBox=document.getElementById("answer");
  answerBox.value="";
  answerBox.className="";
  answerBox.focus();
  const idx=Math.floor(Math.random()*remainingCards.length);
  currentCard=remainingCards.splice(idx,1)[0];
  askInFrench = currentMode==='fr-en'?true:currentMode==='en-fr'?false:Math.random()<0.5;
  document.getElementById("display-word").textContent = askInFrench?currentCard.fr:currentCard.en;
}

// Input Handling
document.getElementById("answer").addEventListener("input",function(){
  const answerBox=document.getElementById("answer");
  let correct = askInFrench?currentCard.en:currentCard.fr;
  let val=answerBox.value.trim();
  if(val === "") { answerBox.className = ""; return; }
  if(val.toLowerCase()===correct.toLowerCase()){
    answerBox.className="correct";
    score++;
    answered++; // ✅ count attempt
    setTimeout(nextWord,300);
  } else if(val.length>=correct.length){
    answerBox.className="incorrect";
    answered++; // ✅ count attempt even if wrong
  }
});

// Right Shift Peek
let peekTimeout;
document.addEventListener("keydown", function(e){
  if(e.code==="ShiftRight" && currentCard){
    clearTimeout(peekTimeout);
    document.getElementById("display-word").style.opacity = 0;
    peekTimeout = setTimeout(() => {
      document.getElementById("display-word").textContent = askInFrench?currentCard.en:currentCard.fr;
      document.getElementById("display-word").style.opacity = 1;
    }, 150);
  }
});
document.addEventListener("keyup", function(e){
  if(e.code==="ShiftRight" && currentCard){
    clearTimeout(peekTimeout);
    document.getElementById("display-word").style.opacity = 0;
    peekTimeout = setTimeout(() => {
      document.getElementById("display-word").textContent = askInFrench?currentCard.fr:currentCard.en;
      document.getElementById("display-word").style.opacity = 1;
    }, 150);
  }
});

// Finish
function finishGame(){
  document.getElementById("game").classList.add("fade-out");
  setTimeout(()=>{
    document.getElementById("game").style.display="none";
    document.getElementById("score-card").style.display="block";
    document.getElementById("game").classList.remove("fade-out");
    document.getElementById("score").textContent = 
      `${score} correct out of ${answered} answered`; // ✅ new logic
  },300);
}

// Play Again
function resetAndPlayAgain() {
  document.getElementById("score-card").classList.add("fade-out");
  setTimeout(() => {
    document.getElementById("score-card").style.display = "none";
    document.getElementById("score-card").classList.remove("fade-out");
    startGame(currentMode, currentCategory);
  }, 300);
}
</script>
</body>
</html>
